---
title: "[WebRTC ë°•ì‚´ë‚´ê¸°] ë°ì´í„° ì±„ë„ êµ¬ì¡°ì™€ í™œìš©ë²•"
description: "WebRTCì˜ RTCDataChannelì„ ì´í•´í•˜ê³ , ì±„íŒ…Â·íŒŒì¼ ì „ì†¡Â·ê²Œì„ ë™ê¸°í™”ê¹Œì§€ ì‹¤ì‹œê°„ ë°ì´í„° ì „ì†¡ì˜ ëª¨ë“  ê²ƒì„ ì•Œì•„ë´…ë‹ˆë‹¤."
slug: "webrtc-deepdive-04"
date: "2025-10-24T08:30:00.000Z"
private: false
tags: ["WebRTC", "RTCDataChannel", "P2P", "ì‹¤ì‹œê°„í†µì‹ ", "SCTP"]
thumbnail: "https://raw.githubusercontent.com/chan9yu/blog9yu-content/refs/heads/main/posts/webrtc-deepdive-04/images/thumbnail.png"
series: WebRTC ë°•ì‚´ë‚´ê¸°!
seriesOrder: 4
---

# ì„œë¡ 

ì•ˆë…•í•˜ì„¸ìš”! ì§€ë‚œ ê¸€ì—ì„œëŠ” **RTCPeerConnectionì˜ ì´ë²¤íŠ¸ íë¦„**ì„ ë°°ì› ìŠµë‹ˆë‹¤.
PeerConnectionì„ ìƒì„±í•˜ê³ , ë¯¸ë””ì–´ íŠ¸ë™ì„ ì£¼ê³ ë°›ëŠ” ë°©ë²•ê¹Œì§€ ì•Œì•„ë³´ì•˜ëŠ”ë°ìš”.

ê·¸ëŸ°ë° í˜¹ì‹œ ì´ëŸ° ìƒê° í•´ë³´ì‹  ì  ì—†ìœ¼ì‹ ê°€ìš”?

**"WebRTCë¡œ ì±„íŒ…ë„ ë§Œë“¤ ìˆ˜ ìˆì„ê¹Œ?"**  
**"ì„œë²„ ì—†ì´ ë¸Œë¼ìš°ì €ë¼ë¦¬ íŒŒì¼ì„ ì£¼ê³ ë°›ì„ ìˆ˜ ìˆì„ê¹Œ?"**  
**"ê²Œì„ì—ì„œ í”Œë ˆì´ì–´ ìœ„ì¹˜ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ë™ê¸°í™”í•˜ë ¤ë©´?"**

ë„¤, ì „ë¶€ ê°€ëŠ¥í•©ë‹ˆë‹¤! WebRTCëŠ” ì˜ìƒÂ·ìŒì„±ë¿ë§Œ ì•„ë‹ˆë¼ **ëª¨ë“  ì¢…ë¥˜ì˜ ë°ì´í„°**ë¥¼ P2Pë¡œ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì´ë¥¼ ë‹´ë‹¹í•˜ëŠ” ê²ƒì´ ë°”ë¡œ **RTCDataChannel**ì…ë‹ˆë‹¤.

ì´ë²ˆ ê¸€ì—ì„œëŠ” ë°ì´í„° ì±„ë„ì´ ë¬´ì—‡ì¸ì§€, ì–¸ì œ ì–´ë–»ê²Œ ì‚¬ìš©í•˜ëŠ”ì§€ ì°¨ê·¼ì°¨ê·¼ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

---

# ë°ì´í„° ì±„ë„ì´ë€?

## ê°œë… ì´í•´í•˜ê¸°

RTCDataChannelì€ **ë‘ ë¸Œë¼ìš°ì €ê°€ ì§ì ‘ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ì„ ìˆ˜ ìˆëŠ” í†µë¡œ**ì…ë‹ˆë‹¤.
ë§ˆì¹˜ ë‘ ì‚¬ëŒì´ ì‹¤ë¡œ ì „í™”ê¸°ë¥¼ ë§Œë“¤ì–´ ëŒ€í™”í•˜ë“¯ì´, ë¸Œë¼ìš°ì €ë¼ë¦¬ ì§ì ‘ ì—°ê²°ë˜ëŠ” ê±°ì£ .

ì˜ìƒ í†µí™”ë¥¼ í•˜ë©´ì„œ ì±„íŒ…ë„ í•˜ê³ , íŒŒì¼ë„ ì£¼ê³ ë°›ê³ , ê²Œì„ ë°ì´í„°ë„ ë™ê¸°í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì„œë²„ë¥¼ ê±°ì¹˜ì§€ ì•Šê¸° ë•Œë¬¸ì— **ë¹ ë¥´ê³ , ì„œë²„ ë¹„ìš©ë„ ì ˆì•½**ë©ë‹ˆë‹¤.

> ğŸ§ ì„œë²„ë¥¼ ì™„ì „íˆ ì•ˆ ê±°ì¹ ê¹Œ?
>
> DataChannelì€ ì—°ê²°ì´ ì„±ë¦½ë˜ë©´ ë³´í†µ ë¸Œë¼ìš°ì € ê°„ P2Pë¡œ í†µì‹ í•©ë‹ˆë‹¤.
> ë‹¤ë§Œ **ì¼ë¶€ ë„¤íŠ¸ì›Œí¬ì—ì„œëŠ” TURN ë¦´ë ˆì´ë¥¼ í†µí•´ ì„œë²„ë¥¼ ê²½ìœ í•  ìˆ˜ ìˆì–´ìš”.**
> ì´ ê²½ìš° ëŒ€ì—­í­ ë¹„ìš©ì´ ë°œìƒí•©ë‹ˆë‹¤.

## WebSocketê³¼ ë­ê°€ ë‹¤ë¥¼ê¹Œ?

ì±„íŒ…ì´ë‚˜ ì‹¤ì‹œê°„ ë°ì´í„° ì „ì†¡ì´ë¼ê³  í•˜ë©´ ë³´í†µ WebSocketì„ ë– ì˜¬ë¦¬ì‹œì£ ?
DataChannelë„ ë¹„ìŠ·í•˜ì§€ë§Œ í° ì°¨ì´ê°€ ìˆìŠµë‹ˆë‹¤.

**WebSocket**

ì‚¬ìš©ìA -> **ì„œë²„** -> ì‚¬ìš©ìB  
ëª¨ë“  ë°ì´í„°ê°€ ì„œë²„ë¥¼ ê±°ì³ì•¼ í•©ë‹ˆë‹¤.

**DataChannel**

ì‚¬ìš©ìA -> -> -> ì‚¬ìš©ìB  
í•œ ë²ˆ ì—°ê²°ë˜ë©´ í”¼ì–´ë¼ë¦¬ ì§ì ‘ í†µì‹ í•©ë‹ˆë‹¤.

| íŠ¹ì§•      | WebSocket        | RTCDataChannel |
| --------- | ---------------- | -------------- |
| ì—°ê²° ë°©ì‹ | ì„œë²„ë¥¼ í†µí•œ ì¤‘ê³„ | P2P ì§ì ‘ ì—°ê²°  |
| ì§€ì—° ì‹œê°„ | ì¤‘ê°„             | ë§¤ìš° ë‚®ìŒ      |
| ì„œë²„ ë¶€í•˜ | ë†’ìŒ             | ì—†ìŒ (ì—°ê²° í›„) |
| ì‹ ë¢°ì„±    | í•­ìƒ ë³´ì¥        | ì„ íƒ ê°€ëŠ¥      |
| ìˆœì„œ ë³´ì¥ | í•­ìƒ ë³´ì¥        | ì„ íƒ ê°€ëŠ¥      |

ê°€ì¥ í° ì°¨ì´ëŠ” **ì¤‘ê°„ì— ì„œë²„ê°€ ì—†ë‹¤**ëŠ” ê²ƒì…ë‹ˆë‹¤.
í™”ìƒ í†µí™” ì¤‘ì— ì±„íŒ…ì„ í•˜ê±°ë‚˜ íŒŒì¼ì„ ë³´ë‚´ë„ ì„œë²„ íŠ¸ë˜í”½ì´ ì¦ê°€í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

---

# ìŠ¤íŠ¸ë¦¼ ì œì–´ ì „ì†¡ í”„ë¡œí† ì½œ (Stream Control Transmission Protocol, SCTP)

RTCDataChannelì€ ë‚´ë¶€ì ìœ¼ë¡œ **[SCTP](https://developer.mozilla.org/ko/docs/Glossary/SCTP)**ë¼ëŠ” í”„ë¡œí† ì½œì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

> ğŸ’¡ **SCTPë€?**
>
> "ìš°ì²´êµ­"ì²˜ëŸ¼ ìƒê°í•˜ë©´ ì‰½ìŠµë‹ˆë‹¤.
> ì°½êµ¬ê°€ ì—¬ëŸ¬ ê°œë¼ì„œ ì¤„ì´ ì•ˆ ê¼¬ì´ê³ , ì˜ˆë¹„ ë„ë¡œê¹Œì§€ í™•ë³´í•œ ë°°ì†¡ ì‹œìŠ¤í…œì´ì—ìš”.
>
> ê° ì†Œí¬(ë©”ì‹œì§€)ë§ˆë‹¤ **ì¼ë°˜ íƒë°°(ì‹ ë¢°ì„± ë³´ì¥)**ì²˜ëŸ¼ ë°˜ë“œì‹œ ì „ë‹¬í• ì§€,
> **í€µ(ë¹ ë¥¸ ì „ë‹¬)**ì²˜ëŸ¼ ëŠ¦ìœ¼ë©´ ë²„ë¦¬ê¸°ë¡œ í• ì§€ ê³ ë¥¼ ìˆ˜ ìˆê³ ,
> **ìˆœì„œëŒ€ë¡œ ë°›ì„ì§€?** **ë¹¨ë¦¬ ì˜¤ëŠ” ëŒ€ë¡œ ë°›ì„ì§€?**ì— ëŒ€í•œ ë°©ì‹ë„ ì°½êµ¬ë³„ë¡œ ì •í•  ìˆ˜ ìˆì–´ìš”.
>
> í•œ ì°½êµ¬ê°€ ë§‰í˜€ë„ ë‹¤ë¥¸ ì°½êµ¬ëŠ” ê³„ì† ì²˜ë¦¬ë˜ê³ ,
> í•œ ë„ë¡œê°€ ë§‰íˆë©´ ë‹¤ë¥¸ ê²½ë¡œë¡œ ìë™ ìš°íšŒí•©ë‹ˆë‹¤.

ê° ì±„ë„ë³„ë¡œ "Reliable/Unreliable, Ordered/Unordered" ì •ì±…ì„ ì •í•©ë‹ˆë‹¤

## ë„¤ ê°€ì§€ ì „ì†¡ ëª¨ë“œ

SCTPëŠ” ë‘ ê°€ì§€ ì˜µì…˜ì„ ì¡°í•©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì‹ ë¢°ì„± (Reliable vs Unreliable)

**Reliable (ì‹ ë¢°ì„± ë³´ì¥)**

- í¸ì§€ê°€ ë¶„ì‹¤ë˜ë©´ ë‹¤ì‹œ ë³´ëƒ„
- ëª¨ë“  ë°ì´í„°ê°€ **ë°˜ë“œì‹œ** ë„ì°©
- ì˜ˆ: ì±„íŒ… ë©”ì‹œì§€, íŒŒì¼ ì „ì†¡

**Unreliable (ì‹ ë¢°ì„± ë¯¸ë³´ì¥)**

- í¸ì§€ê°€ ë¶„ì‹¤ë˜ì–´ë„ ë‹¤ì‹œ ë³´ë‚´ì§€ ì•ŠìŒ
- **ë¹ ë¥¸ ì „ë‹¬**ì´ ë” ì¤‘ìš”í•  ë•Œ
- ì˜ˆ: ê²Œì„ ì¢Œí‘œ, ì‹¤ì‹œê°„ ì„¼ì„œê°’

### ìˆœì„œ (Ordered vs Unordered)

**Ordered (ìˆœì„œ ë³´ì¥)**

- ë³´ë‚¸ ìˆœì„œëŒ€ë¡œ ë°›ìŒ
- 1 -> 2 -> 3 ìˆœì„œê°€ ì¤‘ìš”
- ì˜ˆ: íŒŒì¼ ì¡°ê°, ëŒ€í™” ë‚´ìš©

**Unordered (ìˆœì„œ ë¯¸ë³´ì¥)**

- ë¹¨ë¦¬ ë„ì°©í•˜ëŠ” ê²ƒë¶€í„° ë°›ìŒ
- ìµœì‹  ì •ë³´ë§Œ ì¤‘ìš”
- ì˜ˆ: í˜„ì¬ ìœ„ì¹˜, ì„¼ì„œ ìµœì‹ ê°’

## ì™œ ì´ë ‡ê²Œ ì„ íƒí•´ì„œ ì‚¬ìš©í•˜ëŠ” ê±¸ê¹Œ?

ì‹¤ì‹œê°„ ê²Œì„ì„ ì˜ˆë¡œ ë“¤ì–´ë³¼ê²Œìš”.

**í”Œë ˆì´ì–´ ìœ„ì¹˜ ì „ì†¡**

- 1ì´ˆ ì „ ìœ„ì¹˜ëŠ” ì˜ë¯¸ ì—†ìŒ -> Unreliable
- ìµœì‹  ìœ„ì¹˜ë§Œ ì¤‘ìš” -> Unordered
- ì„¤ì •

```javascript
{
  ordered: false,
  maxRetransmits: 0
}
```

**ì±„íŒ… ë©”ì‹œì§€**

- ëª¨ë“  ë©”ì‹œì§€ê°€ ë„ì°©í•´ì•¼ í•¨ -> Reliable
- ìˆœì„œê°€ ë°”ë€Œë©´ ëŒ€í™”ê°€ ì´ìƒí•´ì§ -> Ordered
- ì„¤ì •

```javascript
{
  ordered: true, // ê¸°ë³¸ê°’
}
```

ì´ëŸ° ì‹ìœ¼ë¡œ ìƒí™©ì— ë§ëŠ” ìµœì ì˜ ë°©ë²•ì„ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!

---

# ë°ì´í„° ì±„ë„ ë§Œë“¤ê¸°

![DataChannel ìƒì„± ë° ì—°ê²° íë¦„](https://raw.githubusercontent.com/chan9yu/blog9yu-content/refs/heads/main/posts/webrtc-deepdive-04/images/image-01.png)

## ê¸°ë³¸ ì‚¬ìš©ë²•

ë°ì´í„° ì±„ë„ì€ í•œìª½ì—ì„œ ë§Œë“¤ê³ , ë‹¤ë¥¸ ìª½ì—ì„œ ë°›ìŠµë‹ˆë‹¤.
ë§ˆì¹˜ ì „í™”ë¥¼ ê±°ëŠ” ì‚¬ëŒê³¼ ë°›ëŠ” ì‚¬ëŒì²˜ëŸ¼ìš”.

**ë°œì‹ ì (ì±„ë„ì„ ë§Œë“œëŠ” ìª½)**

```javascript
const pc = new RTCPeerConnection();

// ì±„ë„ ìƒì„±
const channel = pc.createDataChannel("chat");

// ì—°ê²°ë˜ë©´ ë©”ì‹œì§€ ë³´ë‚¼ ìˆ˜ ìˆìŒ
channel.onopen = () => {
	console.log("âœ… ì±„ë„ ì—°ê²°ë¨!");
	channel.send("ì•ˆë…•í•˜ì„¸ìš”!");
};

// ë©”ì‹œì§€ ë°›ê¸°
channel.onmessage = (event) => {
	console.log("ë°›ì€ ë©”ì‹œì§€:", event.data);
};
```

**ìˆ˜ì‹ ì (ì±„ë„ì„ ë°›ëŠ” ìª½)**

```javascript
// ìƒëŒ€ë°©ì´ ë§Œë“  ì±„ë„ ë°›ê¸°
pc.ondatachannel = (event) => {
	const channel = event.channel;
	console.log("ğŸ“¡ ì±„ë„ ìˆ˜ì‹ ë¨");

	channel.onmessage = (event) => {
		console.log("ë°›ì€ ë©”ì‹œì§€:", event.data);
		// ë°›ì€ ë©”ì‹œì§€ì— ë‹µì¥
		channel.send("ë°˜ê°€ì›Œìš”!");
	};
};
```

> âš ï¸ **ì£¼ì˜ì‚¬í•­**
>
> `createDataChannel()`ì„ í˜¸ì¶œí•˜ëŠ” ìª½ì´ Offerë¥¼ ë¨¼ì € ë³´ë‚´ì•¼ í•©ë‹ˆë‹¤.
> Answerë¥¼ ë³´ë‚´ëŠ” ìª½ì€ `ondatachannel`ë¡œë§Œ ì±„ë„ì„ ë°›ì„ ìˆ˜ ìˆì–´ìš”.

## ì˜µì…˜ ì„¤ì •í•˜ê¸°

ì±„ë„ì„ ë§Œë“¤ ë•Œ ì „ì†¡ ë°©ì‹ì„ ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```javascript
// ì±„íŒ…ìš© - ëª¨ë“  ë©”ì‹œì§€ê°€ ìˆœì„œëŒ€ë¡œ ë„ì°©
const chatChannel = pc.createDataChannel("chat", {
	ordered: true // ìˆœì„œ ë³´ì¥ (ê¸°ë³¸ê°’)
});

// ê²Œì„ìš© - ë¹ ë¥¸ ì „ì†¡, ì†ì‹¤ í—ˆìš©
const gameChannel = pc.createDataChannel("position", {
	ordered: false, // ìˆœì„œ ìƒê´€ì—†ìŒ
	maxRetransmits: 0 // ì¬ì „ì†¡ ì•ˆ í•¨
});

// íŒŒì¼ ì „ì†¡ìš© - ì™„ì „í•œ ì‹ ë¢°ì„±
const fileChannel = pc.createDataChannel("file", {
	ordered: true
	// maxRetransmitsì™€ maxPacketLifeTime ë‘˜ ë‹¤ ì—†ìœ¼ë©´
	// ë¬´í•œ ì¬ì „ì†¡ = ì™„ì „í•œ ì‹ ë¢°ì„±
});
```

### ì£¼ìš” ì˜µì…˜ ì„¤ëª…

| ì˜µì…˜                | ì˜ë¯¸               | ì‚¬ìš© ì˜ˆì‹œ          |
| ------------------- | ------------------ | ------------------ |
| `ordered`           | ìˆœì„œ ë³´ì¥ ì—¬ë¶€     | ì±„íŒ…, íŒŒì¼         |
| `maxRetransmits`    | ìµœëŒ€ ì¬ì „ì†¡ íšŸìˆ˜   | ì¤‘ìš”í•œ ëª…ë ¹        |
| `maxPacketLifeTime` | íŒ¨í‚· ìˆ˜ëª… (ë°€ë¦¬ì´ˆ) | ì‹¤ì‹œê°„ ì„¼ì„œ ë°ì´í„° |

> ğŸ’¡ **ì¬ì „ì†¡ ì˜µì…˜ ì„ íƒ ê¸°ì¤€**
>
> - ë‘˜ ë‹¤ ì•ˆ ì“°ë©´: ë¬´í•œ ì¬ì „ì†¡ (ì™„ì „í•œ ì‹ ë¢°ì„±)
> - `maxRetransmits: 3`: 3ë²ˆê¹Œì§€ë§Œ ì¬ì‹œë„
> - `maxPacketLifeTime: 1000`: 1ì´ˆ ì•ˆì— ëª» ê°€ë©´ í¬ê¸°
> - ë‘˜ ë‹¤ ì“°ë©´ ì•ˆ ë©ë‹ˆë‹¤!

---

# ìƒí™©ë³„ ì„¤ì • ê°€ì´ë“œ

ì‹¤ì œë¡œ ì–´ë–¤ ì„¤ì •ì„ ì¨ì•¼ í• ê¹Œìš”? ëŒ€í‘œì ì¸ ì‚¬ìš© ì‚¬ë¡€ë¥¼ ë³¼ê²Œìš”.

## 1. ì±„íŒ… ì• í”Œë¦¬ì¼€ì´ì…˜

**ìš”êµ¬ì‚¬í•­**: ëª¨ë“  ë©”ì‹œì§€ê°€ ìˆœì„œëŒ€ë¡œ ë„ì°©í•´ì•¼ í•¨

```javascript
const chatChannel = pc.createDataChannel("chat", {
	ordered: true
	// ì™„ì „í•œ ì‹ ë¢°ì„± (ê¸°ë³¸ê°’)
});

chatChannel.onopen = () => {
	// ì—°ê²°ë˜ë©´ ë©”ì‹œì§€ ë³´ë‚¼ ìˆ˜ ìˆìŒ
	document.getElementById("sendBtn").disabled = false;
};

chatChannel.onmessage = (event) => {
	// í™”ë©´ì— ë©”ì‹œì§€ í‘œì‹œ
	const msg = JSON.parse(event.data);
	addMessageToChat(msg.text, msg.sender);
};

// ë©”ì‹œì§€ ë³´ë‚´ê¸°
function sendMessage(text) {
	const message = {
		text: text,
		sender: "me",
		timestamp: Date.now()
	};
	chatChannel.send(JSON.stringify(message));
}
```

**ì™œ ì´ ì„¤ì •?**

- ëŒ€í™”ê°€ ë’¤ì„ì´ë©´ ì•ˆ ë˜ë‹ˆê¹Œ â†’ `ordered: true`
- ë©”ì‹œì§€ë¥¼ ë†“ì¹˜ë©´ ì•ˆ ë˜ë‹ˆê¹Œ â†’ ì™„ì „í•œ ì‹ ë¢°ì„± (ì¬ì „ì†¡ ì œí•œ ì—†ìŒ)

## 2. ì‹¤ì‹œê°„ ê²Œì„ ì¢Œí‘œ

**ìš”êµ¬ì‚¬í•­**: ìµœì‹  ìœ„ì¹˜ë§Œ ì¤‘ìš”, ì´ì „ ë°ì´í„°ëŠ” ë¬´ì‹œ

```javascript
const positionChannel = pc.createDataChannel("position", {
	ordered: false, // ìˆœì„œ ìƒê´€ì—†ìŒ
	maxRetransmits: 0 // ì¬ì „ì†¡ ì•ˆ í•¨ = ë¹ ë¥¸ ì „ë‹¬
});

// 60fpsë¡œ ìœ„ì¹˜ ì „ì†¡
setInterval(() => {
	const position = {
		x: player.x,
		y: player.y,
		timestamp: Date.now()
	};

	positionChannel.send(JSON.stringify(position));
}, 16); // ì•½ 60fps

positionChannel.onmessage = (event) => {
	const pos = JSON.parse(event.data);
	updateRemotePlayer(pos.x, pos.y);
};
```

**ì™œ ì´ ì„¤ì •?**

- 0.5ì´ˆ ì „ ìœ„ì¹˜ëŠ” ì˜ë¯¸ ì—†ìœ¼ë‹ˆê¹Œ â†’ `ordered: false`
- ì¬ì „ì†¡í•˜ëŠ” ë™ì•ˆ ìƒˆ ìœ„ì¹˜ê°€ ë˜ ì˜¤ë‹ˆê¹Œ â†’ `maxRetransmits: 0`

## 3. íŒŒì¼ ì „ì†¡

**ìš”êµ¬ì‚¬í•­**: ëª¨ë“  ë°ì´í„° ì¡°ê°ì´ ì •í™•íˆ ë„ì°©í•´ì•¼ í•¨

```javascript
const fileChannel = pc.createDataChannel("file", {
	ordered: true
	// ì™„ì „í•œ ì‹ ë¢°ì„±
});

async function sendFile(file) {
	// 1. íŒŒì¼ ì •ë³´ ë¨¼ì € ë³´ë‚´ê¸°
	fileChannel.send(
		JSON.stringify({
			type: "file-start",
			name: file.name,
			size: file.size
		})
	);

	// 2. 16KBì”© ì˜ë¼ì„œ ë³´ë‚´ê¸°
	const CHUNK_SIZE = 16384;
	const buffer = await file.arrayBuffer();

	for (let i = 0; i < buffer.byteLength; i += CHUNK_SIZE) {
		const chunk = buffer.slice(i, i + CHUNK_SIZE);
		fileChannel.send(chunk);

		// ì§„í–‰ë¥  í‘œì‹œ
		const progress = ((i + CHUNK_SIZE) / buffer.byteLength) * 100;
		console.log(`ì „ì†¡ ì¤‘: ${Math.min(progress, 100).toFixed(1)}%`);
	}

	// 3. ì „ì†¡ ì™„ë£Œ ì‹ í˜¸
	fileChannel.send(JSON.stringify({ type: "file-end" }));
}
```

**ì™œ ì´ ì„¤ì •?**

- íŒŒì¼ ì¡°ê° ìˆœì„œê°€ ë°”ë€Œë©´ íŒŒì¼ì´ ê¹¨ì§ â†’ `ordered: true`
- í•˜ë‚˜ë¼ë„ ë¹ ì§€ë©´ íŒŒì¼ì´ ê¹¨ì§ â†’ ì™„ì „í•œ ì‹ ë¢°ì„±

---

# ì‹œë‚˜ë¦¬ì˜¤ë³„ ë¹ ë¥¸ ì°¸ê³ í‘œ

| ì‚¬ìš© ì‚¬ë¡€       | ordered | maxRetransmits / maxPacketLifeTime | ì„¤ëª…                          |
| --------------- | ------- | ---------------------------------- | ----------------------------- |
| **ì±„íŒ…**        | true    | â€“                                  | ìˆœì„œ ì¤‘ìš”, ì™„ì „ ì‹ ë¢°          |
| **íŒŒì¼ ì „ì†¡**   | true    | â€“                                  | ëª¨ë“  ì¡°ê° í•„ìš”                |
| **ê²Œì„ ì¢Œí‘œ**   | false   | `0`                                | ìµœì‹ ê°’ë§Œ ì¤‘ìš”(ì†ì‹¤ í—ˆìš©)      |
| **ì„¼ì„œ ë°ì´í„°** | false   | `maxPacketLifeTime: 100` (ì˜ˆì‹œ)    | ì¼ì • ì‹œê°„ ê²½ê³¼ì‹œ íê¸°         |
| **ì œì–´ ëª…ë ¹**   | true    | `3`                                | ì œí•œ ì¬ì „ì†¡(íƒ€ì„ì•„ì›ƒ í›„ í¬ê¸°) |

---

# ë°ì´í„° ë³´ë‚´ê³  ë°›ê¸°

## ë‹¤ì–‘í•œ ë°ì´í„° íƒ€ì…

ë°ì´í„° ì±„ë„ì€ ì—¬ëŸ¬ ì¢…ë¥˜ì˜ ë°ì´í„°ë¥¼ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```javascript
// 1. ë¬¸ìì—´
channel.send("ì•ˆë…•í•˜ì„¸ìš”!");

// 2. JSON ë°ì´í„°
const data = { type: "move", x: 100, y: 200 };
channel.send(JSON.stringify(data));

// 3. ë°”ì´ë„ˆë¦¬ ë°ì´í„° (ArrayBuffer)
const buffer = new ArrayBuffer(8);
channel.send(buffer);

// 4. Blob (íŒŒì¼ ë“±)
const blob = new Blob(["Hello"], { type: "text/plain" });
channel.send(blob);
```

## ë°›ì„ ë•Œ íƒ€ì… êµ¬ë¶„í•˜ê¸°

```javascript
channel.onmessage = (event) => {
	const data = event.data;

	// ë¬¸ìì—´ì¸ì§€ í™•ì¸
	if (typeof data === "string") {
		console.log("í…ìŠ¤íŠ¸:", data);

		// JSONì¸ì§€ í™•ì¸
		try {
			const json = JSON.parse(data);
			console.log("JSON:", json);
		} catch (e) {
			// ì¼ë°˜ ë¬¸ìì—´
		}
	}
	// ArrayBuffer
	else if (data instanceof ArrayBuffer) {
		console.log("ë°”ì´ë„ˆë¦¬ ë°ì´í„°:", data.byteLength, "bytes");
	}
	// Blob
	else if (data instanceof Blob) {
		data.text().then((text) => console.log("Blob:", text));
	}
};
```

---

# ì£¼ì˜í•  ì 

## 1. ë²„í¼ ê´€ë¦¬

ë°ì´í„°ë¥¼ ë„ˆë¬´ ë¹¨ë¦¬ ë§ì´ ë³´ë‚´ë©´ ë²„í¼ê°€ ê°€ë“ ì°¹ë‹ˆë‹¤.

```javascript
// âŒ ë‚˜ìœ ì˜ˆ: ë²„í¼ í™•ì¸ ì—†ì´ ê³„ì† ë³´ë‚´ê¸°
for (let i = 0; i < 10000; i++) {
	channel.send(`ë©”ì‹œì§€ ${i}`); // ë²„í¼ ì´ˆê³¼ ê°€ëŠ¥!
}

// âœ… ì¢‹ì€ ì˜ˆ: ë²„í¼ í™•ì¸í•˜ë©´ì„œ ë³´ë‚´ê¸°
function safeSend(data) {
	// ë²„í¼ê°€ 1MB ë¯¸ë§Œì¼ ë•Œë§Œ ë³´ë‚´ê¸°
	if (channel.bufferedAmount < 1024 * 1024) {
		channel.send(data);
		return true;
	}

	console.warn("ë²„í¼ ê°€ë“ ì°¸, ì ì‹œ ëŒ€ê¸°");
	return false;
}

// ë²„í¼ ì—¬ìœ  ìƒê¸°ë©´ ì•Œë¦¼
channel.bufferedAmountLowThreshold = 65536; // 64KB
channel.onbufferedamountlow = () => {
	console.log("ë²„í¼ ì—¬ìœ  ìƒê¹€!");
};
```

## 2. ì±„ë„ ìƒíƒœ í™•ì¸

```javascript
// ë©”ì‹œì§€ ë³´ë‚´ê¸° ì „ì— í•­ìƒ í™•ì¸
if (channel.readyState === "open") {
	channel.send("Hello!");
} else {
	console.log("ì±„ë„ì´ ì•„ì§ ì—´ë¦¬ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤");
}

// readyState ê°’
// "connecting" - ì—°ê²° ì¤‘
// "open" - ì‚¬ìš© ê°€ëŠ¥
// "closing" - ë‹«íˆëŠ” ì¤‘
// "closed" - ë‹«í˜
```

## 3. ë©”ì‹œì§€ í¬ê¸° ì œí•œ

ë¸Œë¼ìš°ì €ë§ˆë‹¤ í•œ ë²ˆì— ë³´ë‚¼ ìˆ˜ ìˆëŠ” í¬ê¸°ê°€ ë‹¤ë¦…ë‹ˆë‹¤.

```javascript
// ë¸Œë¼ìš°ì €ì— ë”°ë¼ ì§€ì› ì—¬ë¶€ê°€ ë‹¤ë¦„
console.log(pc.sctp?.maxMessageSize); // ì§€ì› ì•ˆ í•˜ë©´ undefined
// ì•ˆì „í•˜ê²Œ 16KB ì²­í¬ë¡œ ì „ì†¡í•˜ëŠ” ê²ƒì„ ê¶Œì¥

// í° íŒŒì¼ì€ ì˜ë¼ì„œ ë³´ë‚´ê¸°
const CHUNK_SIZE = 16384; // 16KB (ì•ˆì „í•œ í¬ê¸°)

async function sendLargeData(file) {
	const buffer = await file.arrayBuffer();

	for (let i = 0; i < buffer.byteLength; i += CHUNK_SIZE) {
		const chunk = buffer.slice(i, i + CHUNK_SIZE);

		// ë²„í¼ í™•ì¸í•˜ë©´ì„œ ë³´ë‚´ê¸°
		while (channel.bufferedAmount > CHUNK_SIZE * 2) {
			await new Promise((resolve) => setTimeout(resolve, 10));
		}

		channel.send(chunk);
	}
}
```

## 4. ë²„í¼ ì €ìˆ˜ì¤€ ì´ë²¤íŠ¸ í™œìš© ì˜ˆì‹œ

```javascript
const queue = [];
channel.bufferedAmountLowThreshold = 64 * 1024;

function safeEnqueue(data) {
	queue.push(data);
	pump();
}

function pump() {
	while (queue.length && channel.readyState === "open" && channel.bufferedAmount < channel.bufferedAmountLowThreshold) {
		channel.send(queue.shift());
	}
}

channel.onbufferedamountlow = pump;
```

---

# ë¸Œë¼ìš°ì € ì§€ì›

RTCDataChannelì€ ëª¨ë˜ ë¸Œë¼ìš°ì €ì—ì„œ ì§€ì›í•©ë‹ˆë‹¤. ë‹¤ë§Œ iOSëŠ” ë°±ê·¸ë¼ìš´ë“œ/ì €ì „ë ¥ ì •ì±…ì˜ ì˜í–¥ì„ ë°›ì•„ ì—°ê²° ìœ ì§€ê°€ ì œí•œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

| ë¸Œë¼ìš°ì € | ì§€ì› ë²„ì „ | íŠ¹ì´ì‚¬í•­                               |
| -------- | --------- | -------------------------------------- |
| Chrome   | 26+       | ì™„ì „ ì§€ì›                              |
| Firefox  | 22+       | ì™„ì „ ì§€ì›                              |
| Safari   | 11+       | iOS ë°±ê·¸ë¼ìš´ë“œ ì œí•œ (ì¬ì—°ê²° ë¡œì§ ê¶Œì¥) |
| Edge     | 79+       | Chromeê³¼ ë™ì¼                          |

---

# ì‹¤ì „ í™œìš© ì‚¬ë¡€

## 1. P2P ì±„íŒ…

```javascript
// ì±„ë„ ë§Œë“¤ê¸°
const chat = pc.createDataChannel("chat", { ordered: true });

chat.onopen = () => {
	document.getElementById("status").textContent = "ì—°ê²°ë¨";
};

chat.onmessage = (event) => {
	const msg = JSON.parse(event.data);
	addMessageToUI(msg.text, msg.sender);
};

// ë©”ì‹œì§€ ë³´ë‚´ê¸°
function sendMessage(text) {
	if (chat.readyState === "open") {
		const message = {
			text: text,
			sender: "me",
			timestamp: Date.now()
		};
		chat.send(JSON.stringify(message));
		addMessageToUI(text, "me");
	}
}
```

**ì¥ì **

- ì„œë²„ë¥¼ ê±°ì¹˜ì§€ ì•Šì•„ ë¹ ë¦„
- ì„œë²„ ë¹„ìš© ì ˆì•½
- í™”ìƒ í†µí™”í•˜ë©´ì„œ ì±„íŒ… ê°€ëŠ¥

## 2. íŒŒì¼ ê³µìœ 

```javascript
// íŒŒì¼ ì „ì†¡ ì±„ë„
const file = pc.createDataChannel("file", { ordered: true });

async function shareFile(selectedFile) {
	// 1. íŒŒì¼ ì •ë³´ ë¨¼ì € ë³´ë‚´ê¸°
	file.send(
		JSON.stringify({
			name: selectedFile.name,
			size: selectedFile.size,
			type: "start"
		})
	);

	// 2. íŒŒì¼ ë°ì´í„°ë¥¼ 16KBì”© ë‚˜ëˆ ì„œ ë³´ë‚´ê¸°
	const CHUNK = 16384;
	const buffer = await selectedFile.arrayBuffer();

	for (let i = 0; i < buffer.byteLength; i += CHUNK) {
		file.send(buffer.slice(i, i + CHUNK));

		// ì§„í–‰ë¥  í‘œì‹œ
		const percent = ((i / buffer.byteLength) * 100).toFixed(0);
		updateProgress(percent);
	}

	// 3. ì™„ë£Œ ì‹ í˜¸
	file.send(JSON.stringify({ type: "end" }));
}
```

**ì¥ì **

- Dropboxì²˜ëŸ¼ ì„œë²„ ì—†ì´ íŒŒì¼ ê³µìœ 
- ëŒ€ìš©ëŸ‰ íŒŒì¼ë„ ì§ì ‘ ì „ì†¡
- ì„œë²„ ì €ì¥ ê³µê°„ ë¶ˆí•„ìš”

## 3. ê²Œì„ ë™ê¸°í™”

```javascript
// ê²Œì„ ë°ì´í„° ì±„ë„ (ë¹ ë¥¸ ì „ì†¡)
const game = pc.createDataChannel("game", {
	ordered: false,
	maxRetransmits: 0
});

// í”Œë ˆì´ì–´ ìœ„ì¹˜ë¥¼ 60fpsë¡œ ì „ì†¡
function sendPosition() {
	const pos = {
		x: player.x,
		y: player.y,
		rotation: player.rotation
	};

	if (game.readyState === "open") {
		game.send(JSON.stringify(pos));
	}

	requestAnimationFrame(sendPosition);
}

// ìƒëŒ€ í”Œë ˆì´ì–´ ìœ„ì¹˜ ë°›ê¸°
game.onmessage = (event) => {
	const pos = JSON.parse(event.data);
	updateOtherPlayer(pos.x, pos.y, pos.rotation);
};
```

**ì¥ì **

- ë§¤ìš° ë‚®ì€ ì§€ì—° ì‹œê°„ (50-200ms)
- ì„œë²„ ë¶€í•˜ ì—†ìŒ
- P2P ë©€í‹°í”Œë ˆì´ ê²Œì„ êµ¬í˜„ ê°€ëŠ¥

---

# ì •ë¦¬

ì´ë²ˆ ê¸€ì—ì„œëŠ” **RTCDataChannel**ì— ëŒ€í•´ ì•Œì•„ë´¤ìŠµë‹ˆë‹¤.

**í•µì‹¬ ë‚´ìš©**

- ë°ì´í„° ì±„ë„ì€ **ë¸Œë¼ìš°ì €ë¼ë¦¬ ì§ì ‘ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ëŠ” í†µë¡œ**
- **SCTP** í”„ë¡œí† ì½œë¡œ ì‹ ë¢°ì„±ê³¼ ìˆœì„œë¥¼ ìœ ì—°í•˜ê²Œ ì œì–´
- ìƒí™©ì— ë§ê²Œ **4ê°€ì§€ ëª¨ë“œ ì¡°í•©** ê°€ëŠ¥
  - Reliable/Unreliable (ì‹ ë¢°ì„±)
  - Ordered/Unordered (ìˆœì„œ)

**ì‹œë‚˜ë¦¬ì˜¤ë³„ ì„¤ì •**

| ìš©ë„        | ì„¤ì •                                     |
| ----------- | ---------------------------------------- |
| ì±„íŒ…        | `ordered: true` (ì™„ì „í•œ ì‹ ë¢°ì„±)          |
| íŒŒì¼ ì „ì†¡   | `ordered: true` (ì™„ì „í•œ ì‹ ë¢°ì„±)          |
| ê²Œì„ ì¢Œí‘œ   | `ordered: false, maxRetransmits: 0`      |
| ì„¼ì„œ ë°ì´í„° | `ordered: false, maxPacketLifeTime: 100` |

**ì£¼ì˜ì‚¬í•­**

- ë²„í¼ í™•ì¸í•˜ë©´ì„œ ë°ì´í„° ë³´ë‚´ê¸°
- ì±„ë„ ìƒíƒœ í™•ì¸ (`readyState`)
- í° íŒŒì¼ì€ 16KBì”© ì˜ë¼ì„œ ì „ì†¡

**WebRTC ì „ì²´ ê·¸ë¦¼**

ì§€ê¸ˆê¹Œì§€ WebRTC ì‹œë¦¬ì¦ˆì—ì„œ ë‹¤ë£¬ ë‚´ìš©ì„ ì •ë¦¬í•˜ë©´?

1. **ì—°ê²° êµ¬ì¡°**: ì‹œê·¸ë„ë§, SDP, ICE, STUN/TURN
2. **ë¯¸ë””ì–´**: ì¹´ë©”ë¼, ë§ˆì´í¬, í™”ë©´ ê³µìœ 
3. **ì œì–´**: PeerConnection, ì´ë²¤íŠ¸, í’ˆì§ˆ ê´€ë¦¬
4. **ë°ì´í„°**: ì±„íŒ…, íŒŒì¼, ê²Œì„ ë“± ëª¨ë“  ë°ì´í„° ì „ì†¡

WebRTCëŠ” **ì˜ìƒÂ·ìŒì„±Â·ë°ì´í„°ë¥¼ ëª¨ë‘ P2Pë¡œ ì „ì†¡**í•  ìˆ˜ ìˆëŠ” ê°•ë ¥í•œ í”Œë«í¼ì…ë‹ˆë‹¤.
í™”ìƒ í†µí™”ë§Œì´ ì•„ë‹ˆë¼ ì‹¤ì‹œê°„ í˜‘ì—…, íŒŒì¼ ê³µìœ , ê²Œì„, IoT ë“± ë‹¤ì–‘í•œ ë¶„ì•¼ì— í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì§€ê¸ˆê¹Œì§€ ì´ë¡ ì„ ì •ë¦¬í•œ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ê°„ë‹¨í•œ 1:1 ì‹¤ì‹œê°„ í™”ìƒìƒë‹´ ì„œë¹„ìŠ¤ë¥¼ ë§Œë“¤ì–´ë³¼ ì˜ˆì •ì…ë‹ˆë‹¤.
ëê¹Œì§€ ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤!
