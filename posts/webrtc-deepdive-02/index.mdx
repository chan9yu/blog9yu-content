---
title: "[WebRTC ë°•ì‚´ë‚´ê¸°] ë¯¸ë””ì–´ ìŠ¤íŠ¸ë¦¼ê³¼ íŠ¸ë™ ì™„ë²½ ì´í•´"
description: "WebRTCì˜ MediaStreamê³¼ MediaStreamTrackì„ ê¹Šì´ ì´í•´í•˜ê³ , getUserMediaë¶€í„° íŠ¸ë™ ì œì–´, í’ˆì§ˆ ê´€ë¦¬ê¹Œì§€ ì‹¤ì „ ì˜ˆì œì™€ í•¨ê»˜ ì•Œì•„ë´…ë‹ˆë‹¤."
slug: "webrtc-deepdive-02"
date: "2025-10-13T12:44:00.000Z"
private: false
tags: ["WebRTC", "MediaStream", "MediaStreamTrack", "ì‹¤ì‹œê°„í†µì‹ "]
thumbnail: "https://raw.githubusercontent.com/chan9yu/blog9yu-content/refs/heads/main/posts/webrtc-deepdive-02/images/thumbnail.png"
series: WebRTC ë°•ì‚´ë‚´ê¸°!
seriesOrder: 2
---

# ì„œë¡ 

ì•ˆë…•í•˜ì„¸ìš”! ì§€ë‚œ ê¸€ì—ì„œëŠ” WebRTCì˜ ê¸°ë³¸ ê°œë…ê³¼ ì—°ê²° êµ¬ì¡°ì— ëŒ€í•´ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤.  
ì‹œê·¸ë„ë§, SDP, NAT ë¬¸ì œ í•´ê²°, ê·¸ë¦¬ê³  ë‹¤ì–‘í•œ ì•„í‚¤í…ì²˜ íŒ¨í„´ê¹Œì§€ **ì—°ê²°(Connection)** ìì²´ë¥¼ ì´í•´í•˜ëŠ” ë° ì§‘ì¤‘í–ˆì—ˆì£ .

ê·¸ë ‡ë‹¤ë©´ ì—°ê²°ì´ ëœ í›„, ì‹¤ì œë¡œ **ì£¼ê³ ë°›ëŠ” ë°ì´í„°ëŠ” ë¬´ì—‡ì¼ê¹Œìš”?**  
ë°”ë¡œ **ë¯¸ë””ì–´ ìŠ¤íŠ¸ë¦¼(MediaStream)**ê³¼ **ë¯¸ë””ì–´ íŠ¸ë™(MediaStreamTrack)**ì…ë‹ˆë‹¤.

ì²˜ìŒ WebRTCë¡œ í™”ìƒ í†µí™”ë¥¼ êµ¬í˜„í•  ë•Œ `getUserMedia()`ë¥¼ ì‚¬ìš©í•´ ì¹´ë©”ë¼ë¥¼ ì¼œê³ , `addTrack()`ìœ¼ë¡œ íŠ¸ë™ì„ ì¶”ê°€í•˜ëŠ” ì½”ë“œë¥¼ ì ‘í•´ë³´ì…¨ì„ ê²ë‹ˆë‹¤. í•˜ì§€ë§Œ **"ìŠ¤íŠ¸ë¦¼ê³¼ íŠ¸ë™ì€ ë¬´ì—‡ì´ ë‹¤ë¥¼ê¹Œ? ì–¸ì œ ì–´ë–¤ ê±¸ ì¨ì•¼ í• ê¹Œ?"**ë¼ëŠ” ì˜ë¬¸ì´ ìƒê¸°ê¸° ì‰½ìŠµë‹ˆë‹¤.

ì´ë²ˆ ê¸€ì—ì„œëŠ” `MediaStream`ê³¼ `MediaStreamTrack`ì˜ ê°œë…ì„ ì •ë¦¬í•˜ê³ , ì‹¤ì œ WebRTCì—ì„œ ì–´ë–»ê²Œ í™œìš©ë˜ëŠ”ì§€ ë‹¨ê³„ë³„ë¡œ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

![ì „ì²´ êµ¬ì¡° ê°œìš”](https://raw.githubusercontent.com/chan9yu/blog9yu-content/refs/heads/main/posts/webrtc-deepdive-02/images/image-01.png)

---

# Media Capture and Streams APIë€?

**[Media Capture and Streams API](https://developer.mozilla.org/ko/docs/Web/API/Media_Capture_and_Streams_API)**(ì¤„ì—¬ì„œ MediaStream API)ëŠ” WebRTCì™€ í•¨ê»˜ ì‚¬ìš©ë˜ëŠ” í•µì‹¬ APIë¡œ, **ì˜¤ë””ì˜¤ì™€ ë¹„ë””ì˜¤ ë°ì´í„°ë¥¼ ìº¡ì²˜í•˜ê³  ìŠ¤íŠ¸ë¦¬ë°**í•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

## ìŠ¤íŠ¸ë¦¼(Stream)ì´ë€?

ìŠ¤íŠ¸ë¦¼ì€ **ìŒì„±, ì˜ìƒ, ë°ì´í„° ë“±ì˜ ì‘ì€ ì¡°ê°ë“¤ì´ í•˜ë‚˜ì˜ ì¤„ê¸°ë¥¼ ì´ë£¨ë©° ì „ì†¡ë˜ëŠ” ë°ì´í„° íë¦„**ì…ë‹ˆë‹¤. ë§ˆì¹˜ ë¬¼ì´ íë¥´ë“¯ì´ ì—°ì†ì ìœ¼ë¡œ ë°ì´í„°ê°€ ì „ë‹¬ë©ë‹ˆë‹¤.

## MediaStream APIê°€ ì œê³µí•˜ëŠ” ê²ƒ

1. **ë¯¸ë””ì–´ ìŠ¤íŠ¸ë¦¼ê³¼ íŠ¸ë™**: ì˜¤ë””ì˜¤/ë¹„ë””ì˜¤ë¥¼ ë‹´ëŠ” ì»¨í…Œì´ë„ˆì™€ ì‹¤ì œ ë°ì´í„°
2. **ì œì•½ ì¡°ê±´(Constraints)**: í•´ìƒë„, í”„ë ˆì„ë¥  ë“± ë°ì´í„° í˜•ì‹ ì œì–´
3. **ë¹„ë™ê¸° ì²˜ë¦¬**: ë¯¸ë””ì–´ ì ‘ê·¼ ì‹œ ì„±ê³µ/ì‹¤íŒ¨ ì½œë°±ê³¼ ì´ë²¤íŠ¸ ì œê³µ

---

# MediaStream ì´í•´í•˜ê¸°

## MediaStreamì´ë€?

MediaStreamì€ **0ê°œ ì´ìƒì˜ MediaStreamTrackì„ ë‹´ëŠ” ì»¨í…Œì´ë„ˆ**ì…ë‹ˆë‹¤.  
ì‰½ê²Œ ë§í•´ ì—¬ëŸ¬ íŠ¸ë™(ì˜¤ë””ì˜¤, ë¹„ë””ì˜¤)ì„ í•˜ë‚˜ë¡œ ë¬¶ì–´ ê´€ë¦¬í•˜ëŠ” ë°”êµ¬ë‹ˆì…ë‹ˆë‹¤.

## MediaStreamì˜ êµ¬ì¡°

![MediaStreamê³¼ íŠ¸ë™ êµ¬ì¡°](https://raw.githubusercontent.com/chan9yu/blog9yu-content/refs/heads/main/posts/webrtc-deepdive-02/images/image-02.png)

ê° MediaStreamTrackì€ **í•˜ë‚˜ ì´ìƒì˜ ì±„ë„**ì„ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

> ì˜ˆ) ìŠ¤í…Œë ˆì˜¤ ì˜¤ë””ì˜¤ëŠ” ì™¼ìª½/ì˜¤ë¥¸ìª½ 2ê°œ ì±„ë„

## MediaStreamì˜ ì…ë ¥ê³¼ ì¶œë ¥

MediaStreamì€ **í•˜ë‚˜ì˜ ì…ë ¥(source)**ê³¼ **í•˜ë‚˜ì˜ ì¶œë ¥(consumer)**ì„ ê°€ì§‘ë‹ˆë‹¤.

![ì…ë ¥ê³¼ ì¶œë ¥ íë¦„](https://raw.githubusercontent.com/chan9yu/blog9yu-content/refs/heads/main/posts/webrtc-deepdive-02/images/image-03.png)

### ì…ë ¥ ì†ŒìŠ¤

**Local MediaStream** (`getUserMedia()` ë˜ëŠ” `getDisplayMedia()`ë¡œ ìƒì„±)

- ì¹´ë©”ë¼
- ë§ˆì´í¬
- í™”ë©´ ê³µìœ 

**Non-local MediaStream** (ì™¸ë¶€ì—ì„œ ìƒì„±)

- ë„¤íŠ¸ì›Œí¬(RTCPeerConnection)
- ë¯¸ë””ì–´ ìš”ì†Œ(`<video>`, `<audio>`)
- Web Audio API

### ì¶œë ¥ ëŒ€ìƒ

- `<video>` ë˜ëŠ” `<audio>` ìš”ì†Œ
- RTCPeerConnection (ì›ê²© í”¼ì–´ë¡œ ì „ì†¡)
- MediaRecorder (ë…¹í™”)
- Web Audio API

---

# MediaDevices - ë¯¸ë””ì–´ ì¥ì¹˜ ì ‘ê·¼

## MediaDevicesë€?

`MediaDevices`ëŠ” **ì¹´ë©”ë¼, ë§ˆì´í¬, í™”ë©´ ê³µìœ  ë“± í˜„ì¬ ì—°ê²°ëœ ë¯¸ë””ì–´ ì…ë ¥ ì¥ì¹˜ì— ì ‘ê·¼**í•˜ëŠ” ë°©ë²•ì„ ì œê³µí•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ì…ë‹ˆë‹¤.

```javascript
// navigator.mediaDevicesë¥¼ í†µí•´ ì ‘ê·¼
const devices = navigator.mediaDevices;
```

## ì£¼ìš” ë©”ì„œë“œ

### 1. getUserMedia() - ì¹´ë©”ë¼/ë§ˆì´í¬

```javascript
const stream = await navigator.mediaDevices.getUserMedia({
	video: true,
	audio: true
});

// ë¹„ë””ì˜¤ ìš”ì†Œì— ì—°ê²°
document.querySelector("#myVideo").srcObject = stream;
```

### 2. getDisplayMedia() - í™”ë©´ ê³µìœ 

```javascript
const screenStream = await navigator.mediaDevices.getDisplayMedia({
	video: true,
	audio: true // ì‹œìŠ¤í…œ ì˜¤ë””ì˜¤
});
```

### 3. enumerateDevices() - ì¥ì¹˜ ëª©ë¡

```javascript
const devices = await navigator.mediaDevices.enumerateDevices();

devices.forEach((device) => {
	console.log(device.kind, device.label);
	// "videoinput" "FaceTime HD Camera"
	// "audioinput" "MacBook Pro Microphone"
});
```

---

# Constraints - ì œì•½ ì¡°ê±´ ì„¤ì •

ConstraintsëŠ” **MediaStreamì˜ ë‚´ìš©ë¬¼ì„ ì œì–´**í•©ë‹ˆë‹¤.  
ë¯¸ë””ì–´ íƒ€ì…, í•´ìƒë„, í”„ë ˆì„ë¥  ë“±ì„ ì„¸ë°€í•˜ê²Œ ì¡°ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ê¸°ë³¸ ì‚¬ìš©ë²•

```javascript
const stream = await navigator.mediaDevices.getUserMedia({
	video: {
		width: { ideal: 1280 },
		height: { ideal: 720 },
		frameRate: { ideal: 30 }
	},
	audio: {
		echoCancellation: true,
		noiseSuppression: true
	}
});
```

## Constraints í‚¤ì›Œë“œ

| í‚¤ì›Œë“œ  | ì˜ë¯¸         | ë™ì‘                 |
| ------- | ------------ | -------------------- |
| `exact` | ì •í™•íˆ ì´ ê°’ | ë¶ˆê°€ëŠ¥í•˜ë©´ ì—ëŸ¬ ë°œìƒ |
| `ideal` | ì´ìƒì ì¸ ê°’  | ìµœëŒ€í•œ ë§ì¶”ë ¤ ì‹œë„   |
| `min`   | ìµœì†Œê°’       | ì´ ê°’ ì´ìƒ           |
| `max`   | ìµœëŒ€ê°’       | ì´ ê°’ ì´í•˜           |

## ë¹„ë””ì˜¤ Constraints

```javascript
video: {
  width: { min: 640, ideal: 1280, max: 1920 },
  height: { min: 480, ideal: 720, max: 1080 },
  frameRate: { max: 30 },
  facingMode: 'user' // ì „ë©´ ì¹´ë©”ë¼ (ëª¨ë°”ì¼)
}
```

## ì˜¤ë””ì˜¤ Constraints

```javascript
audio: {
  echoCancellation: true,      // ì—ì½” ì œê±°
  noiseSuppression: true,       // ë…¸ì´ì¦ˆ ì œê±°
  autoGainControl: true,        // ìë™ ë³¼ë¥¨ ì¡°ì ˆ
  sampleRate: { ideal: 48000 }  // ìƒ˜í”Œë§ ë ˆì´íŠ¸
}
```

---

# MediaStreamTrack

## MediaStreamTrackì´ë€?

MediaStreamTrackì€ **ì‹¤ì œ ë¯¸ë””ì–´ ë°ì´í„°ë¥¼ ë‹´ëŠ” ê°œë³„ ë‹¨ìœ„**ì…ë‹ˆë‹¤.  
í•˜ë‚˜ì˜ íŠ¸ë™ì€ í•˜ë‚˜ì˜ ë¯¸ë””ì–´ íƒ€ì…(ì˜¤ë””ì˜¤ ë˜ëŠ” ë¹„ë””ì˜¤)ë§Œ ë‹´ë‹¹í•©ë‹ˆë‹¤.

## íŠ¸ë™ì˜ ì¢…ë¥˜ (kind)

```javascript
track.kind; // "audio" ë˜ëŠ” "video"
```

**ì˜¤ë””ì˜¤ íŠ¸ë™**: ë§ˆì´í¬, ì‹œìŠ¤í…œ ì˜¤ë””ì˜¤, Web Audio  
**ë¹„ë””ì˜¤ íŠ¸ë™**: ì¹´ë©”ë¼, í™”ë©´ ê³µìœ , Canvas

## íŠ¸ë™ì˜ ìƒíƒœ (readyState)

```javascript
track.readyState; // "live" ë˜ëŠ” "ended"
```

### live

íŠ¸ë™ì´ í™œì„± ìƒíƒœì´ë©° ë¯¸ë””ì–´ ë°ì´í„°ë¥¼ ì „ì†¡ ì¤‘ì…ë‹ˆë‹¤.

### ended

íŠ¸ë™ì´ ì¢…ë£Œë˜ì—ˆìœ¼ë©°, ë” ì´ìƒ ë¯¸ë””ì–´ ë°ì´í„°ë¥¼ ì œê³µí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

> ğŸ’¡ í•œë²ˆ endedê°€ ë˜ë©´ ë‹¤ì‹œ liveë¡œ ëŒì•„ê°ˆ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!

íŠ¸ë™ì´ ì¢…ë£Œë˜ëŠ” ê²½ìš°

1. ì‚¬ìš©ìê°€ ê¶Œí•œ ì² íšŒ
2. ì¥ì¹˜ ì—°ê²° í•´ì œ (ì¹´ë©”ë¼ ì œê±° ë“±)
3. `track.stop()` í˜¸ì¶œ
4. ë¸Œë¼ìš°ì € íƒ­ ì¢…ë£Œ

## enabled vs muted

### enabled (ì œì–´ ê°€ëŠ¥)

ê°œë°œìê°€ íŠ¸ë™ì˜ **ì¶œë ¥ì„ ì¼ì‹œì ìœ¼ë¡œ ë„ê±°ë‚˜ ì¼¤ ìˆ˜** ìˆìŠµë‹ˆë‹¤.

```javascript
videoTrack.enabled = false; // ê²€ì€ í™”ë©´ ì „ì†¡
videoTrack.enabled = true; // ì˜ìƒ ì¬ê°œ
```

**ì£¼ì˜ì‚¬í•­**

- `enabled = false`ì—¬ë„ ì¹´ë©”ë¼ LEDëŠ” ê³„ì† ì¼œì ¸ ìˆìŒ
- ì›ê²© í”¼ì–´ì—ê²ŒëŠ” ë³€ê²½ì‚¬í•­ì´ ìë™ ì „ë‹¬ë˜ì§€ ì•ŠìŒ (ë³„ë„ ì‹œê·¸ë„ë§ í•„ìš”)

### muted (ì½ê¸° ì „ìš©)

ë¸Œë¼ìš°ì €ë‚˜ ì‹œìŠ¤í…œì— ì˜í•´ ê²°ì •ë˜ëŠ” **ì½ê¸° ì „ìš©** ì†ì„±ì…ë‹ˆë‹¤.

```javascript
track.addEventListener("mute", () => {
	console.log("íŠ¸ë™ì´ ìŒì†Œê±°ë˜ì—ˆìŠµë‹ˆë‹¤");
});
```

muted ìƒíƒœê°€ ë˜ëŠ” ê²½ìš°

- ì¥ì¹˜ ì—°ê²° ë¬¸ì œ
- ì‹œìŠ¤í…œ ê¶Œí•œ ë³€ê²½
- ë¦¬ì†ŒìŠ¤ ë¶€ì¡±

---

# MediaStream ì£¼ìš” ë©”ì„œë“œì™€ ì´ë²¤íŠ¸

## ë©”ì„œë“œ

### íŠ¸ë™ ê°€ì ¸ì˜¤ê¸°

```javascript
stream.getTracks(); // ëª¨ë“  íŠ¸ë™
stream.getAudioTracks(); // ì˜¤ë””ì˜¤ íŠ¸ë™ë§Œ
stream.getVideoTracks(); // ë¹„ë””ì˜¤ íŠ¸ë™ë§Œ
stream.getTrackById(id); // íŠ¹ì • ID íŠ¸ë™
```

### íŠ¸ë™ ì¶”ê°€/ì œê±°

```javascript
stream.addTrack(track); // íŠ¸ë™ ì¶”ê°€
stream.removeTrack(track); // íŠ¸ë™ ì œê±°
```

### ë³µì œ

```javascript
const clonedStream = stream.clone(); // ìƒˆ IDë¡œ ë³µì œ
```

## ì´ë²¤íŠ¸

```javascript
stream.addEventListener("addtrack", (event) => {
	console.log("ìƒˆ íŠ¸ë™ ì¶”ê°€:", event.track);
});

stream.addEventListener("removetrack", (event) => {
	console.log("íŠ¸ë™ ì œê±°:", event.track);
});

stream.addEventListener("active", () => {
	console.log("ìŠ¤íŠ¸ë¦¼ í™œì„±í™”");
});

stream.addEventListener("inactive", () => {
	console.log("ìŠ¤íŠ¸ë¦¼ ë¹„í™œì„±í™”");
});
```

---

# PeerConnectionì— ë¯¸ë””ì–´ ì—°ê²°í•˜ê¸°

## addTrack() ì‚¬ìš©í•˜ê¸°

![addTrack() ì „ì†¡ êµ¬ì¡°](https://raw.githubusercontent.com/chan9yu/blog9yu-content/refs/heads/main/posts/webrtc-deepdive-02/images/image-04.png)

**2025ë…„ í˜„ì¬ í‘œì¤€ ë°©ì‹**ì…ë‹ˆë‹¤.

> âš ï¸ `addStream()`ì€ deprecatedë˜ì—ˆìœ¼ë¯€ë¡œ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”.

```javascript
const pc = new RTCPeerConnection(config);
const stream = await navigator.mediaDevices.getUserMedia({
	video: true,
	audio: true
});

// ê° íŠ¸ë™ì„ ê°œë³„ì ìœ¼ë¡œ ì¶”ê°€
stream.getTracks().forEach((track) => {
	pc.addTrack(track, stream);
});
```

### ì™œ addTrackì´ addStreamë³´ë‹¤ ì¢‹ì„ê¹Œ?

1. **íŠ¸ë™ ë‹¨ìœ„ ì œì–´**: ê°œë³„ íŠ¸ë™ì„ ë…ë¦½ì ìœ¼ë¡œ ì¶”ê°€/ì œê±°/êµì²´ ê°€ëŠ¥
2. **í‘œì¤€ ì¤€ìˆ˜**: ìµœì‹  WebRTC ìŠ¤í™ì„ ë”°ë¦„
3. **ì¬í˜‘ìƒ ì œì–´**: íŠ¸ë™ ë³€ê²½ ì‹œ ìë™ìœ¼ë¡œ `negotiationneeded` ì´ë²¤íŠ¸ ë°œìƒ
4. **í¬ë¡œìŠ¤ ë¸Œë¼ìš°ì €**: ëª¨ë“  ëª¨ë˜ ë¸Œë¼ìš°ì € ì§€ì›

## ì›ê²© íŠ¸ë™ ìˆ˜ì‹ í•˜ê¸°

```javascript
pc.addEventListener("track", (event) => {
	const [remoteStream] = event.streams;

	document.querySelector("#remoteVideo").srcObject = remoteStream;
});
```

---

# íŠ¸ë™ ë™ì  ì œì–´í•˜ê¸°

## replaceTrack - íŠ¸ë™ êµì²´

**ì¬í˜‘ìƒ ì—†ì´** ì†¡ì‹  ì¤‘ì¸ íŠ¸ë™ì„ êµì²´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![replaceTrack() ë™ì‘ íë¦„](https://raw.githubusercontent.com/chan9yu/blog9yu-content/refs/heads/main/posts/webrtc-deepdive-02/images/image-05.png)

### ì¹´ë©”ë¼ â†” í™”ë©´ ê³µìœ  ì „í™˜

```javascript
async function toggleScreenShare(isSharing) {
	const videoSender = pc.getSenders().find((sender) => sender.track?.kind === "video");

	if (!videoSender) return;

	if (isSharing) {
		// í™”ë©´ ê³µìœ ë¡œ ì „í™˜
		const screenStream = await navigator.mediaDevices.getDisplayMedia({
			video: true
		});
		await videoSender.replaceTrack(screenStream.getVideoTracks()[0]);
	} else {
		// ì¹´ë©”ë¼ë¡œ ë³µê·€
		const cameraStream = await navigator.mediaDevices.getUserMedia({
			video: true
		});
		await videoSender.replaceTrack(cameraStream.getVideoTracks()[0]);
	}
}
```

## íŠ¸ë™ ì œê±°

```javascript
const sender = pc.getSenders().find((s) => s.track === myTrack);
if (sender) {
	pc.removeTrack(sender);
	myTrack.stop(); // íŠ¸ë™ ë¦¬ì†ŒìŠ¤ ì •ë¦¬
}
```

---

# ë¯¸ë””ì–´ ì²˜ë¦¬ íë¦„ ì´í•´í•˜ê¸°

## ì „ì²´ íŒŒì´í”„ë¼ì¸

![ë¯¸ë””ì–´ ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸](https://raw.githubusercontent.com/chan9yu/blog9yu-content/refs/heads/main/posts/webrtc-deepdive-02/images/image-06.png)

### 1ë‹¨ê³„: ìº¡ì²˜ (Capture)

`getUserMedia()`, `getDisplayMedia()`, `captureStream()`

### 2ë‹¨ê³„: ì¸ì½”ë”© (Encoding)

ë¸Œë¼ìš°ì €ê°€ ì½”ë±(VP8, H.264, Opus ë“±)ìœ¼ë¡œ ì••ì¶•

### 3ë‹¨ê³„: ì „ì†¡ (Transmission)

RTP í”„ë¡œí† ì½œë¡œ ë„¤íŠ¸ì›Œí¬ ì „ì†¡

### 4ë‹¨ê³„: ë””ì½”ë”© (Decoding)

ìˆ˜ì‹  ì¸¡ì—ì„œ ì½”ë±ìœ¼ë¡œ ë³µì›

### 5ë‹¨ê³„: ì¬ìƒ (Playback)

`<video>` ë˜ëŠ” `<audio>` ìš”ì†Œë¡œ ì¶œë ¥

## íŠ¸ë™ ë‹¨ìœ„ ì „ì†¡ì˜ ì¥ì 

1. **ë…ë¦½ì  ì œì–´**: ë¹„ë””ì˜¤ì™€ ì˜¤ë””ì˜¤ë¥¼ ê°ê° ì œì–´
2. **ë™ì  êµì²´**: í•„ìš” ì‹œ íŠ¹ì • íŠ¸ë™ë§Œ êµì²´
3. **ì„ íƒì  ì „ì†¡**: ëŒ€ì—­í­ì— ë”°ë¼ ì¼ë¶€ íŠ¸ë™ë§Œ ì „ì†¡
4. **ë©€í‹° ì†ŒìŠ¤**: ì—¬ëŸ¬ ì†ŒìŠ¤ë¥¼ ì¡°í•©í•´ ìƒˆë¡œìš´ ìŠ¤íŠ¸ë¦¼ ìƒì„±

---

# í’ˆì§ˆ ì œì–´í•˜ê¸°

## ì „ì†¡ í’ˆì§ˆ ì¡°ì ˆ

```javascript
const sender = pc.getSenders().find((s) => s.track?.kind === "video");
const params = sender.getParameters();

if (!params.encodings) {
	params.encodings = [{}];
}

// ìµœëŒ€ ë¹„íŠ¸ë ˆì´íŠ¸ 500kbpsë¡œ ì œí•œ
params.encodings[0].maxBitrate = 500000;

// í•´ìƒë„ë¥¼ ì›ë³¸ì˜ 50%ë¡œ ì¶•ì†Œ
params.encodings[0].scaleResolutionDownBy = 2;

await sender.setParameters(params);
```

## ë„¤íŠ¸ì›Œí¬ ì ì‘ (Adaptive Streaming)

ë¸Œë¼ìš°ì €ëŠ” ë„¤íŠ¸ì›Œí¬ ìƒí™©ì„ ìë™ìœ¼ë¡œ ê°ì§€í•˜ì—¬ í’ˆì§ˆì„ ì¡°ì •í•©ë‹ˆë‹¤.  
`chrome://webrtc-internals/`ì—ì„œ ì‹¤ì‹œê°„ í†µê³„ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

# í™•ì¥ ê°œë…

## ë©€í‹° ì†ŒìŠ¤ ê²°í•©

```javascript
const camera = await navigator.mediaDevices.getUserMedia({
	video: true,
	audio: true
});

const screen = await navigator.mediaDevices.getDisplayMedia({
	video: true
});

// ì¹´ë©”ë¼ ì˜¤ë””ì˜¤ + í™”ë©´ ë¹„ë””ì˜¤ ê²°í•©
const combined = new MediaStream([...camera.getAudioTracks(), ...screen.getVideoTracks()]);
```

## Canvas ë¹„ë””ì˜¤ í•©ì„±

```javascript
const canvas = document.createElement("canvas");
canvas.width = 1280;
canvas.height = 720;
const ctx = canvas.getContext("2d");

function drawFrame() {
	ctx.drawImage(video1, 0, 0, 640, 720);
	ctx.drawImage(video2, 640, 0, 640, 720);
	requestAnimationFrame(drawFrame);
}
drawFrame();

const compositeStream = canvas.captureStream(30);
pc.addTrack(compositeStream.getVideoTracks()[0], compositeStream);
```

---

# ì‹¤ì „ íŒ

## 1. ë¦¬ì†ŒìŠ¤ ì •ë¦¬ í•„ìˆ˜

```javascript
function cleanup(stream) {
	stream.getTracks().forEach((track) => track.stop());
}

// React ì˜ˆì‹œ
useEffect(() => {
	return () => cleanup(localStream);
}, [localStream]);
```

## 2. ê¶Œí•œ ì—ëŸ¬ ì²˜ë¦¬

```javascript
try {
	const stream = await navigator.mediaDevices.getUserMedia({ video: true });
} catch (error) {
	if (error instanceof DOMException) {
		if (error.name === "NotAllowedError") {
			alert("ì¹´ë©”ë¼ ê¶Œí•œì„ í—ˆìš©í•´ì£¼ì„¸ìš”");
		} else if (error.name === "NotFoundError") {
			alert("ì¹´ë©”ë¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤");
		}
	}
}
```

## 3. HTTPS í•„ìˆ˜

`getUserMedia()`ëŠ” **ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸(HTTPS)**ì—ì„œë§Œ ì‘ë™í•©ë‹ˆë‹¤.

- ê°œë°œ: `localhost`ëŠ” ì˜ˆì™¸
- í”„ë¡œë•ì…˜: ë°˜ë“œì‹œ HTTPS

## 4. ëª¨ë°”ì¼ ê³ ë ¤ì‚¬í•­

```javascript
// ìë™ì¬ìƒì„ ìœ„í•´ ìŒì†Œê±° í•„ìš”
videoElement.muted = true;
await videoElement.play();
```

---

# ì •ë¦¬

ì´ë²ˆ ê¸€ì—ì„œëŠ” WebRTCì˜ **MediaStreamê³¼ MediaStreamTrack**ì— ëŒ€í•´ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤.

## í•µì‹¬ ìš”ì•½!

### MediaStream

- íŠ¸ë™ë“¤ì„ ë‹´ëŠ” ì»¨í…Œì´ë„ˆ
- ê³ ìœ í•œ `id`ë¡œ ì‹ë³„
- `getTracks()`, `addTrack()`, `removeTrack()` ì œê³µ

### MediaStreamTrack

- ì‹¤ì œ ë¯¸ë””ì–´ ë°ì´í„°
- `kind`: "audio" ë˜ëŠ” "video"
- `readyState`: "live" ë˜ëŠ” "ended"
- `enabled`: ì¶œë ¥ ì œì–´
- `muted`: ì‹œìŠ¤í…œ ìƒíƒœ (ì½ê¸° ì „ìš©)

### ë¯¸ë””ì–´ ì¥ì¹˜ ì ‘ê·¼

- `getUserMedia()`: ì¹´ë©”ë¼/ë§ˆì´í¬
- `getDisplayMedia()`: í™”ë©´ ê³µìœ 
- Constraintsë¡œ í’ˆì§ˆ ì„¤ì •

### íŠ¸ë™ ì œì–´

- `addTrack()`: í‘œì¤€ ì „ì†¡ ë°©ì‹
- `replaceTrack()`: ì¬í˜‘ìƒ ì—†ì´ êµì²´
- í’ˆì§ˆ ì œì–´: `setParameters()`

ë‹¤ìŒ ê¸€ì—ì„œëŠ” **RTCPeerConnection APIì™€ ì´ë²¤íŠ¸ íë¦„**ì„ ë‹¤ë£¨ë©°, ì‹¤ì œ ì—°ê²° í›„ ë°ì´í„°ê°€ ì–´ë–»ê²Œ ì˜¤ê°€ëŠ”ì§€ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.
